<head>
  <style>
    @page {
      size: a4 portrait;
      @frame header_frame {           /* Static Frame */
          -pdf-frame-content: header_content;
          left: 50pt; width: 512pt; top: 20pt; height: 40pt;
      }
      @frame content_frame {          /* Content Frame */
          left: 50pt; width: 512pt; top: 60pt; height: 632pt;
      }
      @frame footer_frame {           /* Another static Frame */
          -pdf-frame-content: footer_content;
          left: 50pt; width: 512pt; top: 780pt; height: 20pt;
      }
    }
    *{
      box-sizing: border-box;
      padding: 0;
      margin: 0;
    }
    body{
      font-size: 14px;
      line-height: 1.5px;
    }
    itens th, itens td{
      padding: 4px; 
      text-align: center; 
      border: 1px solid #ddd; 
    }
    
  </style>
  </head>
  <body>
      <!-- Content for Static Frame 'header_frame' -->
      <header id="header_content">
        {% include "pdf/header.html" %}
      </header>
  
      <!-- Content for Static Frame 'footer_frame' -->
      <div id="footer_content">Página <pdf:pagenumber>
          de <pdf:pagecount>
      </div>
  
      <!-- HTML Content -->
      <div style="border: 2px solid #aaa; text-align:center;">
        <h1 style="font-size: 14px; font-weight: 600; padding: 10px;">
          RELATÓRIO SEMANAL DE &nbsp;{{monday|date:"SHORT_DATE_FORMAT"}}&nbsp; A &nbsp;{{friday|date:"SHORT_DATE_FORMAT"}}&nbsp;
        </h1>
      </div>

      <itens>
        <h2>PRODUTOS TOTAIS</h2>
        <table>
          <thead>
            <tr>
              <th style="background-color: #ddd;">Produto</th>
              <th style="background-color: #ddd;">Quantidade</th>
            </tr>
          </thead>
          <tbody>
            {% for product_name, quantity in total_products.items %}
            <tr>
              <td> {{product_name}}</td>
              <td> {{quantity.quantity}} {{quantity.unit}}</td>
            </tr>
            {% endfor %}
          </tbody>
        </table>
      </itens>

      <h2>INSTITUIÇÕES</h2>

      <itens>
        {% for order in orders %}
        <h3>{{order.institution}}</h3>
        <table>
          <thead>
            <tr>
              <th style="background-color: #ddd;">Produto</th>
              <th style="background-color: #ddd;">Quantidade</th>
            </tr>
          </thead>
          <tbody>
            {% for ordered_product in order.call_products.all %}
            {% if not ordered_product.status == 'denied' %}
            <tr>
                <td>{{ ordered_product.call_product.product.name }}</td>
                {% if ordered_product.status == 'available' %}
                  <td>{{ ordered_product.ordered_quantity }}  {{ ordered_product.call_product.product.unit }}</td>
                {% elif ordered_product.status == 'parcial' %}
                  <td>{{ ordered_product.available_quantity }}  {{ ordered_product.call_product.product.unit }}</td>
                {% endif %}
              </tr>
            {% endif %}
            {% endfor %}

          </tbody>
        </table>
        <br>
        {% endfor %}
      </itens>

  </body>
  </html>